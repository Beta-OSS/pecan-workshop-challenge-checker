<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CTF Challenge Submission</title>
<link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='challenge.css') }}">
</head>
<body>
{% include 'navbar.html' %}

<main>
<h1>Challenges</h1>
<div class="challenge-list">
  {% set categories = {} %}
  {% for id, ch in challenges.items() %}
    {% if ch.category not in categories %}
      {% set _ = categories.update({ch.category: []}) %}
    {% endif %}
    {% set _ = categories[ch.category].append((id, ch)) %}
  {% endfor %}

  {% for category, challenge_list in categories.items() %}
    <details>
      <summary><strong>{{ category }}</strong></summary>
      <ul style="list-style: none; padding-left: 1em;">
        {% for id, ch in challenge_list %}
          <li>
            <button
              data-challenge-id="{{ id }}"
              data-name="{{ ch.name | escape }}"
              data-category="{{ ch.category | escape }}"
              data-description="{{ ch.description | escape }}">
              {{ ch.name }}
            </button>
          </li>
        {% endfor %}
      </ul>
    </details>
  {% endfor %}
</div>

<div class="flag-form" style="display: none;">
  <h2 id="challenge-title"></h2>
  <p><strong>Category:</strong> <span id="challenge-category"></span></p>
  <p id="challenge-description" style="font-style: italic;"></p>
  <input type="text" id="flag-input" placeholder="Enter your flag here" size="30" />
  <button id="submit-flag">Submit Flag</button>
  <div class="result" id="result-message"></div>
</div>

<script src="{{url_for('static', filename='challenge.js')}}"></script>
</main>
</body>
</html>
